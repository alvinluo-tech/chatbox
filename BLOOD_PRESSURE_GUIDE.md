# 🩺 AI血压日志应用 - 使用指南

## 📱 功能概述

这是一个专为老年人设计的AI血压监测应用，集成了语音输入、数据可视化、AI分析和邮件提醒功能。

### ✨ 主要功能

1. **🎤 语音输入血压**
   - 支持中文语音识别
   - 自动解析血压数值（如"120/80"、"收缩压120舒张压80"等）
   - 一键语音录入，操作简单

2. **📊 血压数据可视化**
   - 使用MPAndroidChart显示血压趋势图
   - 支持7天、30天、3个月、全部时间范围筛选
   - 收缩压和舒张压分别显示
   - 统计信息展示（平均值、记录总数等）

3. **🤖 AI智能分析**
   - 基于阿里云通义千问AI
   - 分析血压趋势和健康风险
   - 提供个性化健康建议
   - 适合老年人的温和语言表达

4. **📧 邮件提醒功能**
   - 血压异常时自动发送邮件给家人
   - 包含详细的分析报告和建议
   - 支持自定义邮箱地址

## 🚀 快速开始

### 1. 后端设置

```bash
# 进入后端目录
cd backend

# 安装依赖
pip install -r requirements.txt

# 配置环境变量
cp env.example .env
# 编辑 .env 文件，添加以下配置：
# DASHSCOPE_API_KEY=你的阿里云API密钥
# EMAIL_USER=你的邮箱地址
# EMAIL_PASSWORD=你的邮箱密码或应用密码
```

### 2. 启动后端服务

```bash
python main.py
```

服务将在 `http://localhost:8000` 启动

### 3. Android应用设置

1. 使用Android Studio打开项目
2. 同步Gradle依赖
3. 连接Android设备或启动模拟器
4. 运行应用

## 📖 使用说明

### 血压记录

1. **语音输入**
   - 点击"开始语音输入"按钮
   - 说出血压数值，如"120/80"或"收缩压120舒张压80"
   - 系统会自动识别并解析数值
   - 确认后保存记录

2. **手动输入**
   - 在输入框中填写收缩压和舒张压
   - 可选择填写心率和备注
   - 点击"保存记录"

### 查看血压图表

1. 进入"血压图表"页面
2. 选择时间范围（7天、30天、3个月、全部）
3. 查看血压趋势和统计信息

### AI分析

1. 进入"AI分析"页面
2. 可选填写家人邮箱地址
3. 点击"开始分析"
4. 查看AI分析结果和建议
5. 如有异常，系统会自动发送邮件通知

## 🔧 技术架构

### Android端
- **架构**: Clean Architecture + MVVM
- **UI**: Jetpack Compose
- **数据库**: Room
- **图表**: MPAndroidChart
- **语音识别**: Android Speech Recognition API
- **网络**: Retrofit + OkHttp
- **依赖注入**: Hilt

### 后端
- **框架**: FastAPI
- **AI服务**: 阿里云通义千问
- **邮件服务**: SMTP
- **语言**: Python 3.8+

## 📋 API接口

### 血压分析接口

```http
POST /blood-pressure/analyze
Content-Type: application/json

{
    "records": [
        {
            "systolic": 120,
            "diastolic": 80,
            "heart_rate": 70,
            "timestamp": 1703123456.789,
            "notes": "语音输入"
        }
    ],
    "email": "family@example.com"
}
```

**响应**:
```json
{
    "analysis": "AI分析结果...",
    "recommendations": ["建议1", "建议2"],
    "alert_level": "normal|elevated|high|critical",
    "email_sent": true
}
```

## ⚠️ 注意事项

1. **权限要求**
   - 录音权限：用于语音输入
   - 网络权限：用于API调用
   - 存储权限：用于数据缓存

2. **语音识别**
   - 需要网络连接
   - 建议在安静环境中使用
   - 支持中文语音识别

3. **邮件配置**
   - Gmail需要使用应用密码
   - 其他邮箱服务请参考相应配置

4. **数据安全**
   - 血压数据存储在本地设备
   - 分析数据通过HTTPS传输
   - 邮件内容不包含敏感信息

## 🛠️ 故障排除

### 常见问题

1. **语音识别失败**
   - 检查网络连接
   - 确保麦克风权限已授予
   - 尝试在安静环境中使用

2. **图表不显示**
   - 确保有血压记录数据
   - 检查时间范围设置
   - 重启应用

3. **AI分析失败**
   - 检查后端服务是否运行
   - 验证API密钥配置
   - 确保网络连接正常

4. **邮件发送失败**
   - 检查邮箱配置
   - 验证SMTP设置
   - 确认邮箱密码正确

## 📞 技术支持

如有问题，请检查：
1. Android Studio Logcat日志
2. 后端服务日志
3. 网络连接状态
4. 权限设置

## 🔄 更新日志

### v1.0.0
- ✅ 基础聊天功能
- ✅ 语音输入血压
- ✅ 血压数据可视化
- ✅ AI智能分析
- ✅ 邮件提醒功能
- ✅ 时间范围筛选

---

**祝您使用愉快，身体健康！** 🏥💙
